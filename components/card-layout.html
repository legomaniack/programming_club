<link rel="import" href="../bower_components/polymer/polymer.html">
  
<link rel="import" href="../components/content-card.html">
<link rel="import" href="../components/card-service.html">
  
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">

<dom-module id="card-layout">
<template>
  
	<style>
		:host {
			display: block;
		}
		.content {
			width: 100%;
		}
		.column {
			padding: 30px; 
			max-width: 450px;
		}
		content-card {
			margin-bottom: 20px;
			width: 100%;
		}
		paper-fab {
			position: fixed;
			bottom: 32px;
			right: 	32px;
			--paper-fab-background: #448AFF;
			--paper-fab-keyboard-focus-background: #2979FF;
		}
		paper-dialog {
			max-width: 600px;
			width: calc(100% - 60px);	
		}
	</style>

		
	<card-service id="service" type="{{type}}" cols="{{cols}}" col-num="{{columns}}"></card-service>
	<div class="content layout start around-justified horizontal"> 
		<template is="dom-repeat" items="{{cols}}" as="col">
			<div class="layout vertical flex column">
			<template is="dom-repeat" items="{{col}}" as="card">
				<content-card img="{{card.img}}" postid="{{card.id}}">
					<h2>{{card.title}}</h2>
					<p>{{card.text}}</p>
				</content-card>
			</template>
			</div>
		</template>
	</div>

	<paper-fab on-tap="fab" icon="add" title="add"></paper-fab>
	<paper-dialog id="editdialog">
		<h2>{{editorTitle}}</h2>
		<paper-input value="{{editTitleValue::input}}" required="true" id="post-title" label="Title"></paper-input>
		<paper-input value="{{editSrcValue::input}}" id="image-src" label="Image URL"></paper-input>
		<paper-textarea value="{{editContentValue::input}}" required="true" id="post-body" label="Content"></paper-textarea>
		<div class="buttons">
			<paper-button dialog-dismiss>Cancel</paper-button>
			<paper-button dialog-confirm on-tap="editAccept">Accept</paper-button>
		</div>
	</paper-dialog>

</template>
  <script>
    Polymer({
      is: 'card-layout',
      properties: {
        columnPadding: {
          type: Number,
          value: 30
        },
        columnWidth: {
          type: Number,
          value: 450
        },
		columns: {
			type: Number,
			value: 1
		},
        type: {
          type: String,
          value: 'projects',
          notify: true
        },
		editorTitle: {
          type: String,
          value: 'Create new Project',
          notify: true
        }
      },
      attached: function () { // DO NOT TOUCH
		layout = this;
        this.columns = Math.max(1, Math.floor(layout.clientWidth / (layout.columnWidth + 2 * layout.columnPadding)));
		Polymer.dom(this).setAttribute('unresolved', '');
        window.addEventListener('resize', function () {
          layout.columns = Math.max(1, Math.floor(layout.clientWidth / (layout.columnWidth + 2 * layout.columnPadding)));
		});
		this.$.editdialog.refit();
		this.$.editdialog.addEventListener('iron-overlay-closed', function () {
		  layout.clearEdit();
		});
      },
	  fab: function () {
		this.editorTitle = "Create New Project"
		this.$.editdialog.open();
	  },
	  editAccept: function () {
		
	  },
	  clearEdit: function () { // Call this when dialog is canceled
		this.editTitleValue = "";
		this.editSrcValue = "";
		this.editContentValue = "";
	  }
    });
  </script>
</dom-module>
