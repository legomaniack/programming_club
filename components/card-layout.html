<link rel="import" href="../bower_components/polymer/polymer.html">
  
<link rel="import" href="../components/content-card.html">
<link rel="import" href="../components/card-service.html">
  
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">

<dom-module id="card-layout">
<template>
  
	<style>
		:host {
			display: block;
		}
		.content {
			width: 100%;
		}
		.column {
			padding: 30px; 
			max-width: 450px;
		}
		content-card {
			margin-bottom: 20px;
			width: 100%;
		}
	</style>

		
	<card-service id="service" type="{{type}}" cols="{{cols}}" col-num="{{columns}}"></card-service>
	<div class="content layout start around-justified horizontal"> 
		<template is="dom-repeat" items="{{cols}}" as="col">
			<div class="layout vertical flex column">
			<template is="dom-repeat" items="{{col}}" as="card">
				<content-card img="{{card.img}}" postid="{{card.id}}">
					<h2>{{card.title}}</h2>
					<p>{{card.text}}</p>
				</content-card>
			</template>
			</div>
		</template>
	</div>

</template>
  <script>
    Polymer({
      is: 'card-layout',
      properties: {
        columnPadding: {
          type: Number,
          value: 30
        },
        columnWidth: {
          type: Number,
          value: 450
        },
		columns: {
			type: Number,
			value: 1
		},
        type: {
          type: String,
          value: 'projects',
          notify: true
        }
      },
      attached: function () { // DO NOT TOUCH
		layout = this;
        this.columns = Math.max(1, Math.floor(layout.clientWidth / (layout.columnWidth + 2 * layout.columnPadding)));
		Polymer.dom(this).setAttribute('unresolved', '');
        window.addEventListener('resize', function () {
          layout.columns = Math.max(1, Math.floor(layout.clientWidth / (layout.columnWidth + 2 * layout.columnPadding)));
		});
      }
    });
  </script>
</dom-module>
